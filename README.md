# Pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ°—è»½ã«ä½œã‚Šå§‹ã‚ã‚‰ã‚Œã‚‹ç’°å¢ƒ

## æ¦‚è¦

ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€Pythonãƒ™ãƒ¼ã‚¹ã®ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œç’°å¢ƒã‚’ç°¡å˜ã«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã€ãƒ„ãƒ¼ãƒ«ã‚’èµ·å‹•ã™ã‚‹ãŸã‚ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚Scoopã‚’ä½¿ç”¨ã—ã¦å¿…è¦ãªãƒ„ãƒ¼ãƒ«ã‚„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è‡ªå‹•çš„ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€Pythonã®ä»®æƒ³ç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç’°å¢ƒæ§‹ç¯‰ã®æ‰‹é–“ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã¾ã™ã€‚

---

## ä½¿ã„æ–¹ï¼ˆã¨ã¦ã‚‚ç°¡å˜ğŸ˜ï¼‰

1. ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä»»æ„ã®å ´æ‰€ã«å±•é–‹ã—ã¾ã™ã€‚
2. `_setup.bat` ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
  å‡¦ç†æ¦‚è¦
    - [Scoop](https://scoop.sh/)ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆæœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®å ´åˆï¼‰
    [Scoopã¨ã¯](https://qiita.com/talesleaves/items/0880bf31359715035a3c) / [Windowsã§ç’°å¢ƒã‚’æ¥µåŠ›æ±šã•ãšã«Pythonã‚’å‹•ã‹ã™æ–¹æ³• (Scoopç·¨)](https://qiita.com/rhene/items/a5616857981293d06940)
    - gitã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆScoopä½¿ç”¨ï¼‰
    - gitã®sslbackendã®è¨­å®š
    [Gitã§Windowsã®èªè¨¼å±€ã‚¹ãƒˆã‚¢ã«ç™»éŒ²ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆè¨¼æ˜æ›¸ã‚’ä½¿ç”¨ã™ã‚‹](https://qiita.com/akayuki/items/1497ea6c53b63e8691bd)
    - versions bucketã®è¿½åŠ 
    - Pythonã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆScoopä½¿ç”¨ï¼‰
    - ä»®æƒ³ç’°å¢ƒã®ä½œæˆï¼ˆvenvï¼‰
    - ä»®æƒ³ç’°å¢ƒã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ
    - ä»®æƒ³ç’°å¢ƒã¸pipã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    - å¿…è¦ãªPythonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆ`requirements.txt`ã‚’ä½¿ç”¨ï¼‰
<br>

3. `_start.bat` ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
  å‡¦ç†æ¦‚è¦
    - ä»®æƒ³ç’°å¢ƒã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ
    - å¿…è¦ãªPythonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆ`requirements.txt`ã‚’ä½¿ç”¨ï¼‰
    - ãƒ„ãƒ¼ãƒ«ã®èµ·å‹•ï¼ˆ`app.py`ã‚’å®Ÿè¡Œï¼‰
    - ä»®æƒ³ç’°å¢ƒã®ãƒ‡ã‚£ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ

ã†ã¾ãå‹•ä½œã—ãªã„ã¨ãã¯ã€`_clean.bat`ã‚’å®Ÿè¡Œã—ã€å†åº¦`_setup.bat`ã‹ã‚‰ã‚„ã‚Šç›´ã—ã¦ãã ã•ã„ã€‚

---

## å‹•ä½œç’°å¢ƒ

- Windows 10 ä»¥é™
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šï¼ˆåˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ™‚ã«å¿…è¦ï¼‰

---

## æ¦‚è¦å›³

### ã‚¹ã‚¯ãƒªãƒ—ãƒˆé–¢é€£å›³

:::mermaid

```mermaid
flowchart LR
    developer[<font size="7">ğŸ‘©â€ğŸ’»</font><br>é–‹ç™ºè€…]@{ shape: stadium}
    subgraph venv
        cre((<font size="5">â•</font>))
        activate1((<font size="5">â–¶ï¸</font>))
        subgraph setupvenv [setup on venv]
            installpip[[install pip]]
            installpackages[[pip install -r requirements.txt]]
        end
        deactivate1((<font size="5">â¸ï¸</font>))
        activate2((<font size="5">â–¶ï¸</font>))
        subgraph startvenv [start on venv]
            python[[python]]
        end
        app.py
        deactivate2((<font size="5">â¸ï¸</font>))
    end
    developer -->|ç’°å¢ƒæ§‹ç¯‰| _setup.bat
    _setup.bat -->|ç’°å¢ƒæ§‹ç¯‰| setup_env.ps1
    setup_env.ps1 -->|scoopã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<br>Pythonã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«| scoop[[scoop]]

    _setup.bat -->|ç’°å¢ƒæ§‹ç¯‰| setup_venv.ps1
    setup_venv.ps1 -->|Pythonä»®æƒ³ç’°å¢ƒä½œæˆ| cre

    setup_venv.ps1 -->|ä»®æƒ³ç’°å¢ƒã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ| activate1
    activate1 --> setupvenv
    setup_venv.ps1 -->|pipã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«| installpip
    setup_venv.ps1 -->|requirements.txtã‹ã‚‰<br>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«| installpackages
    setup_venv.ps1 -->|ä»®æƒ³ç’°å¢ƒéã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–<br>| deactivate1
    deactivate1 --> setupvenv
    developer -->|ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°| app.py

    developer -->|ã‚¹ã‚¿ãƒ¼ãƒˆ| _start.bat
    _start.bat -->|ã‚¢ãƒ—ãƒªèµ·å‹•| start_app.ps1
    start_app.ps1 -->|ä»®æƒ³ç’°å¢ƒã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ<br>| activate2
    activate2 --> startvenv
    start_app.ps1 -->|ã‚¢ãƒ—ãƒªèµ·å‹•| python
    python --> app.py
    start_app.ps1 -->|ä»®æƒ³ç’°å¢ƒéã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–<br>| deactivate2
    deactivate2 --> startvenv
```

:::

### ã‚¹ã‚¯ãƒªãƒ—ãƒˆå‹•ä½œã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³

:::mermaid

```mermaid
 sequenceDiagram

    actor Developer as é–‹ç™ºè€…<br>ğŸ‘©â€ğŸ’»
    participant BAT as .bat
    participant SP as .ps1
    participant V as venv
    participant APP as app.py
    participant SC as scoop

    Developer->>BAT: _setup.bat<br>ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯
    activate BAT
    BAT->>SP: setup_env.ps1<br>ç’°å¢ƒæ§‹ç¯‰
    activate SP
    SP->>SC: scoop ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<br>Python ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    activate SC
    SP -->>BAT: å®Œäº†
    deactivate SP

    BAT->>SP: setup_venv.ps1<br>ä»®æƒ³ç’°å¢ƒæ§‹ç¯‰
    activate SP
    SP->>V: ä»®æƒ³ç’°å¢ƒä½œæˆ
    activate V
    SP->>V: activate.bat
    activate V
    SP->>V: pipã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    SP->>V: ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    SP-XV: deactivate.bat
    deactivate V
    SP -->>BAT: å®Œäº†
    deactivate SP
    BAT -->>Developer: å®Œäº†
    deactivate BAT

    Developer->>APP: ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

    Developer->>BAT: _start.bat<br>ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯
    activate BAT
    BAT->>SP: start_app.ps1<br>ãƒ„ãƒ¼ãƒ«ã‚¹ã‚¿ãƒ¼ãƒˆ
    activate SP
    SP->>V: activate.bat
    activate V
    SP->>V: ã‚¢ãƒ—ãƒªèµ·å‹•
    V->>APP: ã‚¢ãƒ—ãƒªèµ·å‹•
    activate APP
    deactivate APP
    destroy APP
    APP-->>V: å®Œäº†

    SP-XV: deactivate.bat
    deactivate V
    SP-->>BAT: å®Œäº†
    deactivate SP
    BAT-->>Developer: å®Œäº†
    deactivate BAT

    deactivate V
    deactivate SC
```
:::

---
